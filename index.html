<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Banco Pichincha | Registro QR</title>
  <meta name="robots" content="noindex,nofollow" />

  <style>
    :root{
      --bg:#0B1220;
      --card:rgba(255,255,255,.06);
      --text:rgba(255,255,255,.92);
      --muted:rgba(255,255,255,.68);
      --brand:#FFD200;
      --ok:#22c55e;
      --err:#ef4444;
      --radius:18px;
      --shadow:0 18px 60px rgba(0,0,0,.45);
      --font:system-ui,-apple-system,Segoe UI,Roboto,Arial;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      min-height:100vh;
      font-family:var(--font);
      color:var(--text);
      background:linear-gradient(180deg,#070A12,var(--bg));
      display:flex;
      align-items:center;
      justify-content:center;
      padding:20px;
    }
    .card{
      width:100%;
      max-width:420px;
      background:var(--card);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:22px;
      border:1px solid rgba(255,255,255,.1);
    }
    .logo{
      width:46px;height:46px;border-radius:14px;
      background:var(--brand);
      color:#111;
      font-weight:800;
      display:grid;place-items:center;
      margin-bottom:12px;
    }
    h1{font-size:18px;margin:8px 0}
    p{font-size:13px;color:var(--muted)}
    .status{
      margin-top:16px;
      padding:14px;
      border-radius:14px;
      background:rgba(255,255,255,.05);
      display:flex;
      gap:10px;
      align-items:flex-start;
    }
    .dot{
      width:10px;height:10px;border-radius:50%;
      background:var(--brand);
      margin-top:5px;
      animation:pulse 1.1s infinite;
    }
    @keyframes pulse{
      0%{transform:scale(1)}
      70%{transform:scale(1.4)}
      100%{transform:scale(1)}
    }
    .ok .dot{background:var(--ok);animation:none}
    .err .dot{background:var(--err);animation:none}
    .footer{
      text-align:center;
      margin-top:14px;
      font-size:11px;
      color:rgba(255,255,255,.5)
    }
  </style>
</head>

<body>
  <div class="card" id="card">
    <div class="logo">BP</div>

    <h1 id="title">Registrando escaneoâ€¦</h1>
    <p id="desc">Este proceso se ejecuta automÃ¡ticamente.</p>

    <div class="status" id="statusBox">
      <div class="dot"></div>
      <div>
        <b id="statusTitle">Procesando</b>
        <p id="statusText">Enviando informaciÃ³n.</p>
      </div>
    </div>

    <div class="footer">Â© Banco Pichincha</div>
  </div>

<script>
  // ðŸ”— URL DE TU FLOW (HTTP TRIGGER)
  const FLOW_URL =
  "https://defaultf5b0d68214974db09019660035554e.72.environment.api.powerplatform.com:443/powerautomate/automations/direct/workflows/58cb8760f3a441f4bfb1ada87e4bbac9/triggers/manual/paths/invoke?api-version=1&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=FjK6F5kKzWu8R8CBjHVMjnJp57WcCrwZ0plJYp2qti0";

  // ðŸ“ ubicaciÃ³n desde la URL
  const params = new URLSearchParams(window.location.search);
  const locationId = (params.get("loc") || "DESCONOCIDO").trim();

  const payload = { locationId };

  fetch(FLOW_URL, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(payload),
    mode: "no-cors"
  })
  .then(() => {
    document.getElementById("card").classList.add("ok");
    document.getElementById("title").textContent = "Listo âœ…";
    document.getElementById("desc").textContent =
      "El escaneo fue registrado correctamente.";
    document.getElementById("statusTitle").textContent = "Registro completado";
    document.getElementById("statusText").textContent =
      "Puedes cerrar esta ventana.";
  })
  .catch(() => {
    document.getElementById("card").classList.add("err");
    document.getElementById("title").textContent = "Error";
    document.getElementById("desc").textContent =
      "No se pudo registrar el escaneo.";
  });
</script>
</body>
</html>
